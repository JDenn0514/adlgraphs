<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="adlgraphs">
<title>data_transformations • adlgraphs</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.8/font.css" rel="stylesheet">
<link href="../deps/Overpass_Mono-0.4.8/font.css" rel="stylesheet">
<link href="../deps/Titillium_Web-0.4.8/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="data_transformations">
<meta property="og:description" content="adlgraphs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">adlgraphs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_transformations.html">data_transformations</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JDenn0514/adlgraphs/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>data_transformations</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JDenn0514/adlgraphs/blob/HEAD/vignettes/data_transformations.Rmd" class="external-link"><code>vignettes/data_transformations.Rmd</code></a></small>
      <div class="d-none name"><code>data_transformations.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JDenn0514/adlgraphs" class="external-link">adlgraphs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://larmarange.github.io/labelled/" class="external-link">labelled</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org" class="external-link">haven</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://waldo.r-lib.org" class="external-link">waldo</a></span><span class="op">)</span></span></code></pre></div>
<p><code>adlgraphs</code> provides three main functions to reduce the
amount of time it takes to perform a few very common data
transformations:</p>
<ul>
<li><p><code><a href="../reference/num_rev.html">num_rev()</a></code> - reverses the values of a vector</p></li>
<li><p><code><a href="../reference/make_dicho.html">make_dicho()</a></code> - converts a vector to a dichotomous
factor</p></li>
<li><p><code><a href="../reference/make_binary.html">make_binary()</a></code> - converts a vector to a binary (0 and
1)</p></li>
</ul>
<div class="section level2">
<h2 id="num_rev">
<code>num_rev()</code><a class="anchor" aria-label="anchor" href="#num_rev"></a>
</h2>
<p><code><a href="../reference/num_rev.html">num_rev()</a></code> was designed with
<code><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">forcats::fct_rev()</a></code> in mind. However, instead of operating
on factors, <code><a href="../reference/num_rev.html">num_rev()</a></code> operates on numeric vectors. Often,
when working with survey data, we want to reverse the values of a
numeric vector. However, when this is done, any underlying metadata of
the variable is lost. The purpose of <code><a href="../reference/num_rev.html">num_rev()</a></code> is to fix
this by automate the process of reversing a numeric vector, while
maintaining the variable and value labels. In addition, this function
adds a new attribute called <code>transformation</code> that describes
the data transformation used to create this variable.</p>
<p>In this vignette, I hope to show you how this function makes life a
lot easier if you want to reverse a variable while maintaining the
metadata. The examples in this vignette get increasingly complex as I
progress.</p>
<p>Let’s look at an example with a fake data set comprised of four
variables. In this data set, <code>w</code> has no value labels or
variable label, <code>x</code> has only a variable label, <code>y</code>
has only value labels, <code>z</code> has both variable and value
labels. This allows us to see how the function provides different
outputs depending on what kind of metadata the function has.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JDenn0514/adlgraphs" class="external-link">adlgraphs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://larmarange.github.io/labelled/" class="external-link">labelled</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org" class="external-link">haven</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://waldo.r-lib.org" class="external-link">waldo</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create the new data</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># add value labels to y and z but not x to see what happens with no labels</span></span>
<span>  <span class="fu">labelled</span><span class="fu">::</span><span class="fu"><a href="https://larmarange.github.io/labelled/reference/val_labels.html" class="external-link">set_value_labels</a></span><span class="op">(</span></span>
<span>    z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`Strongly agree` <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          `Somewhat agree` <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          `Somewhat disagree` <span class="op">=</span> <span class="fl">3</span>,</span>
<span>          `Strongly disagree` <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`Strongly agree` <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          `Somewhat agree` <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          `Somewhat disagree` <span class="op">=</span> <span class="fl">3</span>,</span>
<span>          `Strongly disagree` <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># set variable labels to x and z</span></span>
<span>  <span class="fu">labelled</span><span class="fu">::</span><span class="fu"><a href="https://larmarange.github.io/labelled/reference/var_label.html" class="external-link">set_variable_labels</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"This is the variable label for x"</span>,</span>
<span>    z <span class="op">=</span> <span class="st">"This is the variable label for z"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Now let’s show how this function works in practice as well as how you
would do the same data transformation without this function. We will
start by showing it <code>w</code> because it has no metadata which
makes it relatively easy to replicate without the function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    fun_w <span class="op">=</span> <span class="fu"><a href="../reference/num_rev.html">num_rev</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>,</span>
<span>    <span class="co"># first subtract w from 5 and then use structure to add the metadata</span></span>
<span>    base_w <span class="op">=</span> <span class="fl">5</span> <span class="op">-</span> <span class="va">w</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span>transformation <span class="op">=</span> <span class="st">"Reversing 'w'"</span><span class="op">)</span>,</span>
<span>    .keep <span class="op">=</span> <span class="st">"used"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># see the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;       w fun_w base_w</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     2     3      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     3     2      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1     4      4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     3     2      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     3     2      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     2     3      3</span></span></code></pre></div>
<p>Now let’s check to see if <code>fun_w</code> and <code>base_w</code>
are identical using <code><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">waldo::compare()</a></code>. We can see that there
are no differences between the two vectors. In addition, check the
underlying structure of the data, specifically of the two variables. We
can see that both variables have an attribute called “transformation”
that contains information explaining what happened sort of data
transformation the variables underwent.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use waldo::compare to see if there are differences</span></span>
<span><span class="fu">waldo</span><span class="fu">::</span><span class="fu"><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">compare</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">$</span><span class="va">fun_w</span>, <span class="va">new_df</span><span class="op">$</span><span class="va">base_w</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> No differences</span></span>
<span></span>
<span><span class="co"># check the structure of the data now</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [20 × 3] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ w     : int [1:20] 2 3 1 3 3 2 2 1 4 3 ...</span></span>
<span><span class="co">#&gt;  $ fun_w : num [1:20] 3 2 4 2 2 3 3 4 1 2 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "transformation")= 'glue' chr "Reversing 'w'"</span></span>
<span><span class="co">#&gt;  $ base_w: num [1:20] 3 2 4 2 2 3 3 4 1 2 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "transformation")= chr "Reversing 'w'"</span></span></code></pre></div>
<p>Now let’s check this with <code>x</code> from the new data. Let’s
compare a new variable created using the <code><a href="../reference/num_rev.html">num_rev()</a></code> function
called <code>num_rev_x</code> to a new variable created through a simple
reversal by doing <code>5 - x</code> that we’ll call . We can see that
the values are the same, but hte</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    fun_x <span class="op">=</span> <span class="fu"><a href="../reference/num_rev.html">num_rev</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    sub_x <span class="op">=</span> <span class="fl">5</span> <span class="op">-</span> <span class="va">x</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Since <code>x</code> has a variable label, it will be a bit more
in-depth having to replicate the results we get from the
<code><a href="../reference/num_rev.html">num_rev()</a></code> function. We can see that both variables are the
same. Moreover, what was just one line of code ended up being ~5 lines
of code. While this may not seem like much, it becomes a lot when you
have a bunch of variables to do this over. Now to understand the output
from <code>str(new_df)</code>, there are three things to note here:</p>
<ul>
<li><p>The first is that the first line of each variable indicates the
values in this variable and that there are 10 values.</p></li>
<li><p>The second line shows you the there is a variable label
attribute</p></li>
<li><p>The third line shows you the transformation attribute</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    fun_x <span class="op">=</span> <span class="fu"><a href="../reference/num_rev.html">num_rev</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    <span class="co"># use haven labelled to add the variable label</span></span>
<span>    base_x <span class="op">=</span> <span class="fu">haven</span><span class="fu">::</span><span class="fu"><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></span><span class="op">(</span></span>
<span>      <span class="co"># reverse the vector</span></span>
<span>      <span class="fl">5</span> <span class="op">-</span> <span class="va">x</span>,</span>
<span>      <span class="co"># add the variable label</span></span>
<span>      label <span class="op">=</span> <span class="st">"This is the variable label for x"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="co"># add the attribute for the transformation</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span>transformation <span class="op">=</span> <span class="st">"Reversing 'x'"</span><span class="op">)</span>,</span>
<span>    .keep <span class="op">=</span> <span class="st">"used"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># check to see if the data is the same</span></span>
<span><span class="fu">waldo</span><span class="fu">::</span><span class="fu"><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">compare</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">$</span><span class="va">fun_x</span>, <span class="va">new_df</span><span class="op">$</span><span class="va">base_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> No differences</span></span>
<span></span>
<span><span class="co"># check the structure of the data now</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [20 × 3] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ x     : int [1:20] 1 4 4 2 3 1 3 1 1 4 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "This is the variable label for x"</span></span>
<span><span class="co">#&gt;  $ fun_x : dbl+lbl [1:20] 4, 1, 1, 3, 2, 4, 2, 4, 4, 1, 1, 2, 1, 1, 4, 2, 4, 4, 1, 4</span></span>
<span><span class="co">#&gt;    ..@ label         : chr "This is the variable label for x"</span></span>
<span><span class="co">#&gt;    ..@ transformation: 'glue' chr "Reversing 'x'"</span></span>
<span><span class="co">#&gt;  $ base_x: dbl+lbl [1:20] 4, 1, 1, 3, 2, 4, 2, 4, 4, 1, 1, 2, 1, 1, 4, 2, 4, 4, 1, 4</span></span>
<span><span class="co">#&gt;    ..@ label         : chr "This is the variable label for x"</span></span>
<span><span class="co">#&gt;    ..@ transformation: chr "Reversing 'x'"</span></span></code></pre></div>
<p>Now if we check <code>y</code> we will see something similar. First,
since this variable has value labels, we need tomake sure that we add
the value labels in when doing it in the base model and note that in the
transformation. More importantly, we can see that while the values in
<code>fun_y</code> and <code>base_y</code> changed, the value labels
stayed the same as in <code>y</code>. This is important because the
person’s response didn’t change, the only thing that did is the value we
are associating with it. Moreover, we can that the “label” attribute is
gone now and two “labels” attributes show up instead. This is because
the original variable did not have a variabel label but did have value
labels.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    fun_y <span class="op">=</span> <span class="fu"><a href="../reference/num_rev.html">num_rev</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    <span class="co"># use haven labelled to add the variable label</span></span>
<span>    base_y <span class="op">=</span> <span class="fu">haven</span><span class="fu">::</span><span class="fu"><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></span><span class="op">(</span></span>
<span>      <span class="co"># reverse the vector</span></span>
<span>      <span class="fl">5</span> <span class="op">-</span> <span class="va">y</span>,</span>
<span>      <span class="co"># add the variable label</span></span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strongly disagree"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 <span class="st">"Somewhat disagree"</span> <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 <span class="st">"Somewhat agree"</span> <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                 <span class="st">"Strongly agree"</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="co"># add the attribute for the transformation</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span>transformation <span class="op">=</span> <span class="st">"Reversing 'y' while maintaining correct value labels"</span><span class="op">)</span>,</span>
<span>    .keep <span class="op">=</span> <span class="st">"used"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># preview data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   y                     fun_y                 base_y               </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2<span style="color: #949494;"> [Somewhat agree]</span>    3<span style="color: #949494;"> [Somewhat agree]</span>    3<span style="color: #949494;"> [Somewhat agree]</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 3<span style="color: #949494;"> [Somewhat disagree]</span> 2<span style="color: #949494;"> [Somewhat disagree]</span> 2<span style="color: #949494;"> [Somewhat disagree]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1<span style="color: #949494;"> [Strongly agree]</span>    4<span style="color: #949494;"> [Strongly agree]</span>    4<span style="color: #949494;"> [Strongly agree]</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2<span style="color: #949494;"> [Somewhat agree]</span>    3<span style="color: #949494;"> [Somewhat agree]</span>    3<span style="color: #949494;"> [Somewhat agree]</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 4<span style="color: #949494;"> [Strongly disagree]</span> 1<span style="color: #949494;"> [Strongly disagree]</span> 1<span style="color: #949494;"> [Strongly disagree]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2<span style="color: #949494;"> [Somewhat agree]</span>    3<span style="color: #949494;"> [Somewhat agree]</span>    3<span style="color: #949494;"> [Somewhat agree]</span></span></span>
<span></span>
<span><span class="co"># check to see if the data is the same</span></span>
<span><span class="fu">waldo</span><span class="fu">::</span><span class="fu"><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">compare</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">$</span><span class="va">fun_y</span>, <span class="va">new_df</span><span class="op">$</span><span class="va">base_y</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> No differences</span></span>
<span></span>
<span><span class="co"># check the structure of the data now</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [20 × 3] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ y     : int+lbl [1:20] 2, 3, 1, 2, 4, 2, 2, 4, 2, 3, 1, 3, 3, 4, 2, 2, 1, 3, 1, 4</span></span>
<span><span class="co">#&gt;    ..@ labels: Named int [1:4] 1 2 3 4</span></span>
<span><span class="co">#&gt;    .. ..- attr(*, "names")= chr [1:4] "Strongly agree" "Somewhat agree" "Somewhat disagree" "Strongly disagree"</span></span>
<span><span class="co">#&gt;  $ fun_y : dbl+lbl [1:20] 3, 2, 4, 3, 1, 3, 3, 1, 3, 2, 4, 2, 2, 1, 3, 3, 4, 2, 4, 1</span></span>
<span><span class="co">#&gt;    ..@ labels        : Named num [1:4] 1 2 3 4</span></span>
<span><span class="co">#&gt;    .. ..- attr(*, "names")= chr [1:4] "Strongly disagree" "Somewhat disagree" "Somewhat agree" "Strongly agree"</span></span>
<span><span class="co">#&gt;    ..@ transformation: 'glue' chr "Reversing 'y' while maintaining correct value labels"</span></span>
<span><span class="co">#&gt;  $ base_y: dbl+lbl [1:20] 3, 2, 4, 3, 1, 3, 3, 1, 3, 2, 4, 2, 2, 1, 3, 3, 4, 2, 4, 1</span></span>
<span><span class="co">#&gt;    ..@ labels        : Named num [1:4] 1 2 3 4</span></span>
<span><span class="co">#&gt;    .. ..- attr(*, "names")= chr [1:4] "Strongly disagree" "Somewhat disagree" "Somewhat agree" "Strongly agree"</span></span>
<span><span class="co">#&gt;    ..@ transformation: chr "Reversing 'y' while maintaining correct value labels"</span></span></code></pre></div>
<p><code>z</code> is the most complex variable as it contains both
variable and value labels. What was originally one line of code quickly
became 9 lines of code. To get the same result as
<code><a href="../reference/num_rev.html">num_rev()</a></code>, we need to use <code><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">haven::labelled()</a></code> to
add both the variable label and the value labels and we need to add
<code><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure()</a></code> to add the transformation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    fun_z <span class="op">=</span> <span class="fu"><a href="../reference/num_rev.html">num_rev</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>,</span>
<span>    <span class="co"># use haven labelled to add the variable label</span></span>
<span>    base_z <span class="op">=</span> <span class="fu">haven</span><span class="fu">::</span><span class="fu"><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></span><span class="op">(</span></span>
<span>      <span class="co"># reverse the vector</span></span>
<span>      <span class="fl">5</span> <span class="op">-</span> <span class="va">z</span>,</span>
<span>      <span class="co"># add the variable label</span></span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strongly disagree"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 <span class="st">"Somewhat disagree"</span> <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 <span class="st">"Somewhat agree"</span> <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                 <span class="st">"Strongly agree"</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"This is the variable label for z"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="co"># add the attribute for the transformation</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span>transformation <span class="op">=</span> <span class="st">"Reversing 'z' while maintaining correct value labels"</span><span class="op">)</span>,</span>
<span>    .keep <span class="op">=</span> <span class="st">"used"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># preview data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   z                     fun_z                 base_z               </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 3<span style="color: #949494;"> [Somewhat disagree]</span> 2<span style="color: #949494;"> [Somewhat disagree]</span> 2<span style="color: #949494;"> [Somewhat disagree]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1<span style="color: #949494;"> [Strongly agree]</span>    4<span style="color: #949494;"> [Strongly agree]</span>    4<span style="color: #949494;"> [Strongly agree]</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2<span style="color: #949494;"> [Somewhat agree]</span>    3<span style="color: #949494;"> [Somewhat agree]</span>    3<span style="color: #949494;"> [Somewhat agree]</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1<span style="color: #949494;"> [Strongly agree]</span>    4<span style="color: #949494;"> [Strongly agree]</span>    4<span style="color: #949494;"> [Strongly agree]</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1<span style="color: #949494;"> [Strongly agree]</span>    4<span style="color: #949494;"> [Strongly agree]</span>    4<span style="color: #949494;"> [Strongly agree]</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 3<span style="color: #949494;"> [Somewhat disagree]</span> 2<span style="color: #949494;"> [Somewhat disagree]</span> 2<span style="color: #949494;"> [Somewhat disagree]</span></span></span>
<span></span>
<span><span class="co"># check to see if the data is the same</span></span>
<span><span class="fu">waldo</span><span class="fu">::</span><span class="fu"><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">compare</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">$</span><span class="va">fun_z</span>, <span class="va">new_df</span><span class="op">$</span><span class="va">base_z</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> No differences</span></span>
<span></span>
<span><span class="co"># check the structure of the data now</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [20 × 3] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ z     : int+lbl [1:20] 3, 1, 2, 1, 1, 3, 2, 4, 2, 4, 3, 4, 2, 4, 2, 2, 1, 2, 2, 1</span></span>
<span><span class="co">#&gt;    ..@ labels: Named int [1:4] 1 2 3 4</span></span>
<span><span class="co">#&gt;    .. ..- attr(*, "names")= chr [1:4] "Strongly agree" "Somewhat agree" "Somewhat disagree" "Strongly disagree"</span></span>
<span><span class="co">#&gt;    ..@ label : chr "This is the variable label for z"</span></span>
<span><span class="co">#&gt;  $ fun_z : dbl+lbl [1:20] 2, 4, 3, 4, 4, 2, 3, 1, 3, 1, 2, 1, 3, 1, 3, 3, 4, 3, 3, 4</span></span>
<span><span class="co">#&gt;    ..@ labels        : Named num [1:4] 1 2 3 4</span></span>
<span><span class="co">#&gt;    .. ..- attr(*, "names")= chr [1:4] "Strongly disagree" "Somewhat disagree" "Somewhat agree" "Strongly agree"</span></span>
<span><span class="co">#&gt;    ..@ label         : chr "This is the variable label for z"</span></span>
<span><span class="co">#&gt;    ..@ transformation: 'glue' chr "Reversing 'z' while maintaining correct value labels"</span></span>
<span><span class="co">#&gt;  $ base_z: dbl+lbl [1:20] 2, 4, 3, 4, 4, 2, 3, 1, 3, 1, 2, 1, 3, 1, 3, 3, 4, 3, 3, 4</span></span>
<span><span class="co">#&gt;    ..@ labels        : Named num [1:4] 1 2 3 4</span></span>
<span><span class="co">#&gt;    .. ..- attr(*, "names")= chr [1:4] "Strongly disagree" "Somewhat disagree" "Somewhat agree" "Strongly agree"</span></span>
<span><span class="co">#&gt;    ..@ label         : chr "This is the variable label for z"</span></span>
<span><span class="co">#&gt;    ..@ transformation: chr "Reversing 'z' while maintaining correct value labels"</span></span></code></pre></div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jacob Dennen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
