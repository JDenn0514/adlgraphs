% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/export_freqs_excel.R
\name{export_freqs_excel}
\alias{export_freqs_excel}
\title{Export Frequency Tables to Excel with Professional Formatting}
\usage{
export_freqs_excel(
  data,
  cols,
  group = NULL,
  wt = NULL,
  drop_zero = FALSE,
  decimals = 1,
  na.rm = TRUE,
  show_genpop = FALSE,
  file_name,
  wb_subject = "",
  wb_category,
  add_comments = TRUE,
  sheet = "Frequencies",
  append_to_existing = TRUE
)
}
\arguments{
\item{data}{A data frame or tibble containing the variables to analyze}

\item{cols}{<\code{\link[dplyr:dplyr_tidy_select]{tidy-select}}> Column selection for variables
to create frequency tables for.}

\item{group}{<\code{\link[dplyr:dplyr_tidy_select]{tidy-select}}> Optional grouping variables
for cross-tabulation. Can be a single variable name or vector of variable
names. Supports multiple levels of grouping which will create hierarchical
column headers}

\item{wt}{Optional weight variable name for weighted frequencies. If not provided,
equal weights are applied to all observations}

\item{drop_zero}{Logical. Whether to drop categories with zero frequencies.
Default is \code{FALSE}}

\item{decimals}{Integer. Number of decimal places to display for percentages.
Default is \code{1}}

\item{na.rm}{Logical. Whether to remove missing values before calculating
frequencies. Default is \code{TRUE}}

\item{show_genpop}{Logical. Whether to include a "General Population" column
showing overall frequencies. Default is \code{FALSE}}

\item{file_name}{Character string specifying the output Excel file path}

\item{wb_subject}{Character string for workbook subject metadata. Default is \code{""}}

\item{wb_category}{Character string for workbook category metadata}

\item{add_comments}{Logical. Whether to add hover comments to group headers
explaining what each grouping variable represents. Default is \code{TRUE}}

\item{sheet}{Character string specifying the worksheet name. Default is \code{"Frequencies"}}

\item{append_to_existing}{Logical. Whether to add to an existing Excel file
(if it exists) or create a new one. Default is \code{TRUE}}
}
\value{
Invisibly returns \code{NULL}. The function is called for its side effect
of creating an Excel file
}
\description{
Creates professionally formatted frequency tables in Excel with support for
hierarchical headers, multiple grouping variables, and multi-sheet workbooks.
Tables include proper percentage formatting, borders, footnotes, and optional
comments explaining grouping variables.
}
\details{
The function creates professional frequency tables with the following features:
\itemize{
\item \strong{Hierarchical headers}: Multiple grouping variables create
nested column headers with proper spanning
\item \strong{Smart formatting}: Percentages are formatted as actual Excel
percentages (not text) to avoid warnings and enable calculations
\item \strong{Professional styling}: Tables include borders, centered headers,
and color-coded sections
\item \strong{Informative footnotes}: Automatically generated notes explain
what each level of grouping represents
\item \strong{Multi-sheet support}: Can append new sheets to existing files
with automatic sheet name incrementing to avoid conflicts
\item \strong{Optional comments}: Hover comments on headers provide additional
context about grouping variables
}

When using multiple grouping variables, column names are created by joining
group values with underscores (e.g., "Gen_Z_Male_pct"). The function automatically
creates hierarchical headers that make these relationships clear.
}
\section{Multi-sheet Usage}{

To create multiple sheets in the same Excel file:
\preformatted{
# First call creates the file
export_freqs_excel(data, vars, group = "generation", 
                   file_name = "analysis.xlsx", sheet = "By Generation")

# Subsequent calls add new sheets
export_freqs_excel(data, vars, group = c("generation", "gender"),
                   file_name = "analysis.xlsx", sheet = "By Gen and Gender")
}
}

\examples{
\dontrun{
# Basic frequency table
export_freqs_excel(survey_data, 
                   cols = c(political_party, ideology),
                   file_name = "frequencies.xlsx")

# Grouped by single variable
export_freqs_excel(survey_data,
                   cols = c(political_party, ideology),
                   group = generation,
                   file_name = "by_generation.xlsx")

# Multiple grouping variables with hierarchical headers
export_freqs_excel(survey_data,
                   cols = political_party,
                   group = c(generation, has_children),
                   show_genpop = TRUE,
                   file_name = "detailed_analysis.xlsx")

# Add to existing file with new sheet
export_freqs_excel(survey_data,
                   cols = political_party,
                   group = education,
                   file_name = "detailed_analysis.xlsx",
                   sheet = "By Education")
}

}
\seealso{
\code{\link{get_freqs}} for the underlying frequency calculation function
}
